{% extends "base.html" %}
{% block title %}Dashboard{% endblock %}
{% block content %}
<div class="grid md:grid-cols-3 gap-4">
  <div class="bg-white p-4 rounded-2xl shadow">
    <div class="text-sm text-gray-500">Total Revenue</div>
    <div class="text-2xl font-bold">₦{{ kpis.total_revenue }}</div>
  </div>
  <div class="bg-white p-4 rounded-2xl shadow">
    <div class="text-sm text-gray-500">Orders</div>
    <div class="text-2xl font-bold">{{ kpis.orders }}</div>
  </div>
  <div class="bg-white p-4 rounded-2xl shadow">
    <div class="text-sm text-gray-500">Average Order Value</div>
    <div class="text-2xl font-bold">₦{{ kpis.aov }}</div>
  </div>
</div>

<div class="grid md:grid-cols-2 gap-4 mt-4">
  <div class="bg-white p-4 rounded-2xl shadow">
    <h3 class="font-semibold mb-2">Monthly Revenue</h3>
    <canvas id="revChart"></canvas>
  </div>
  <div class="bg-white p-4 rounded-2xl shadow">
    <h3 class="font-semibold mb-2">By Category</h3>
    <canvas id="catChart"></canvas>
  </div>
</div>
<div class="flex gap-2 mb-4">
    <a href="{% url 'export_csv' %}" class="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700">Export CSV</a>
    <a href="{% url 'export_xlsx' %}" class="px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700">Export XLSX</a>
</div>

<script>
const monthlyLabels = {{ kpis.monthly_labels|safe }};
const monthlyValues = {{ kpis.monthly_values|safe }};
const catLabels = {{ kpis.cat_labels|safe }};
const catValues = {{ kpis.cat_values|safe }};

new Chart(document.getElementById('revChart'), {
  type: 'line',
  data: { labels: monthlyLabels, datasets: [{ label: 'Revenue', data: monthlyValues, tension: 0.3 }] },
  options: { responsive: true, scales: { y: { beginAtZero: true } } }
});

new Chart(document.getElementById('catChart'), {
  type: 'bar',
  data: { labels: catLabels, datasets: [{ label: 'Amount', data: catValues }] },
  options: { responsive: true, scales: { y: { beginAtZero: true } } }
});
</script>
{% endblock %}
